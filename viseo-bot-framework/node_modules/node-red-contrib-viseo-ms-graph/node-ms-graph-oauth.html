<script type="text/javascript">
    RED.nodes.registerType('ms-graph-oauth',{
        category: 'VISEO_AUTH',
        color: '#3FADB5',
        defaults: { 
            name:      { value: undefined },
            appId:     { value: undefined },
            appSecret: { value: undefined },
            redirect:  { value: undefined },
            scope:     { value: undefined },
            state:     { value: undefined },
            url:       { value: undefined },
            code:      { value: undefined },
            refresh:   { value: undefined },
            access:    { value: undefined },
        },
        inputs:  1,
        outputs: 1,
        icon: "microsoft.svg",
        align: "left",
        paletteLabel: 'MS OAuth',
        label: function() { return this.name || "MS Graph Authentication"; }
    });
</script>

<script type="text/x-red" data-template-name="ms-graph-oauth">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-appId"><i class="icon-tag"></i> AppId</label>
        <input type="text" id="node-input-appId" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-appSecret"><i class="icon-tag"></i> App Secret</label>
        <input type="text" id="node-input-appSecret" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-redirect"><i class="icon-tag"></i> Redirect</label>
        <input type="text" id="node-input-redirect" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-scope"><i class="icon-tag"></i> Scope</label>
        <input type="text" id="node-input-scope" placeholder="User.Read">
    </div>
    <div class="form-row">
        <label for="node-input-state"><i class="icon-tag"></i> State</label>
        <input type="text" id="node-input-state" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-url"><i class="icon-tag"></i> Auth URL</label>
        <input type="text" id="node-input-url" placeholder="payload">
    </div>
    <div class="form-row">
        <label for="node-input-code"><i class="icon-tag"></i> Code</label>
        <input type="text" id="node-input-code" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-refresh"><i class="icon-tag"></i> Refresh</label>
        <input type="text" id="node-input-refresh" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-access"><i class="icon-tag"></i> Access</label>
        <input type="text" id="node-input-access" placeholder="">
    </div>
</script>

<script type="text/x-red" data-help-name="ms-graph-oauth">
    Handle various step for OAuth2 Authentication with Microsoft Graph.
    <h2>Fields</h2>
    <ul>
        <li><b>name:</b> can be used to override the default name of the node.</li>
        <li><b>appId:</b> the microsoft application id</li>
        <li><b>appSecret:</b> the microsoft application secret</li>
        <li><b>redirect:</b> the redirect URL after validation (MUST be httpS)</li>
        <li><b>scope:</b> the authorized credential</li>
        <li><b>state:</b> some data to stick with the request</li>
        <li><b>url:</b> property to store the generated URL)</li>
        <li><b>code:</b> code or property to retrieve or store it</li>
        <li><b>refresh:</b> refresh token or property to retrieve or store it</li>
        <li><b>access:</b> access token or property to retrieve or store it</li>
    </ul>
</script>